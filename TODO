only refresh dirty windows
-----
remake Battle to test and refine engine
